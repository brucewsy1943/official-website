<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.official.dao.CompositionMapper" >
  <resultMap id="BaseResultMap" type="com.official.bean.Composition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Oct 12 14:42:14 CST 2019.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="columnId" property="columnid" jdbcType="INTEGER" />
    <result column="attachUrl" property="attachurl" jdbcType="VARCHAR" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="counts" property="counts" jdbcType="INTEGER" />
    <result column="employeeId" property="employeeid" jdbcType="INTEGER" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Oct 12 14:42:14 CST 2019.
    -->
    delete from t_composition
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.official.bean.Composition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Oct 12 14:42:14 CST 2019.
    -->
    insert into t_composition (id, columnId, attachUrl, 
      name, counts, employeeId
      )
    values (#{id,jdbcType=INTEGER}, #{columnid,jdbcType=INTEGER}, #{attachurl,jdbcType=VARCHAR}, 
      #{name,jdbcType=VARCHAR}, #{counts,jdbcType=INTEGER}, #{employeeid,jdbcType=INTEGER}
      )
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.official.bean.Composition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Oct 12 14:42:14 CST 2019.
    -->
    update t_composition
    set columnId = #{columnid,jdbcType=INTEGER},
      attachUrl = #{attachurl,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      counts = #{counts,jdbcType=INTEGER},
      employeeId = #{employeeid,jdbcType=INTEGER}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Oct 12 14:42:14 CST 2019.
    -->
    select id, columnId, attachUrl, name, counts, employeeId
    from t_composition
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectList" resultMap="BaseResultMap" parameterType="com.official.bean.dto.CompositionDto" >
    select id, columnId, attachUrl, name, counts, employeeId from t_composition where columnId = #{columnId} order by counts desc LIMIT #{start},#{length}
  </select>
  <!-- 查詢所有作品的总数-->
  <select id="selectCount" resultType="java.lang.Integer" parameterType="java.lang.Integer">
    select count(0)
    from t_composition
    where columnId = #{columnId}
  </select>

  <!--条件查询 根据作品名查询-->
  <select id="selectCompositionByFileName" resultMap="BaseResultMap" parameterType="java.lang.String" >
    select id, columnId, attachUrl, name, counts, employeeId from t_composition where attachurl = #{fileName}
  </select>
  <!--更新作品-->
  <update id="updateVoteById" parameterType="java.lang.Integer">
       update t_composition set counts = #{count} + 1 where id = #{voteId}
   </update>

</mapper>